/*  Program generated by teval1, a translator and LHS/PRCC evaluator written by Jose L. Segovia,  2002-03, for the Kirschner Lab.  */ 
#include <stdio.h> 
#include <stdlib.h> 
#include <math.h>  
#include <time.h>  
#include <string.h> 
#include "datatype.h"
#define NRANSI 
#include "my_nr.h"
#include "nrutil.h"
double dxsav,*xp,**py;  /* defining declarations */ 
int kmax,kount; 
int nrhs;   /* counts function evaluations */ 
#define NINC 11
#define N 5
#define NFigs 5
	 int myreturnsyscall = 0;

void derivs(double TimeAct, double y[], double dydx[], double C[], double AUX[]) 
{
	nrhs++; 
	AUX[1]=  C[9];  		 /* trucks_in=w1; */
	AUX[2]=  C[9];  		 /* queue_line_a=w1; */
	AUX[3]=  C[9];  		 /* queue_line_b=w1; */
}
void load_constants(double C[]) {  
	 /* Filling initial conditions */ 
	 C[1] =  10 ; 		 /* trucks_init=10 5 25 45 $U ; */
	 C[2] =  50 ; 		 /* percentage_dis=50 10 50 90 $U ; */
	 C[3] =  2 ; 		 /* distance_speed=2 2 4 6 $U ; */
	 C[4] =  10 ; 		 /* flow_left=10 5 15 20 $U ; */
	 C[5] =  10 ; 		 /* flow_right=10 5 15 20 $U ; */
	 C[6] =  20 ; 		 /* flow_up=20 15 25 50 $U ; */
	 C[7] =  20 ; 		 /* flow_down=20 15 25 50 $U ; */
	 C[8] =  0.2 ; 		 /* percentage_minimum_dist=0.2 0.1 0.25 0.5 $U ; */
	 C[9] =  0 ; 		 /* w1=0 ; */
	 } 
/* End of loading constants */ 
void load_auxlevel(double AUX[], double y[], double C[]) {
	 /* Filling leval and aux variables with initial conditions */ 
	 AUX[1] =  0.0; 	 /* trucks_in = */ 
	 AUX[2] =  0.0; 	 /* queue_line_a = */ 
	 AUX[3] =  0.0; 	 /* queue_line_b = */ 
} 


void update_variables_lhs(int c, double C[]) { 
	 /* Updates the following variables at point given by c */ 
	 
	 if (c == 0)   { 
 		 C[1] = 39.2; 
 		 C[2] = 29.6; 
 		 C[3] = 4.98; 
 		 C[4] = 12.125; 
 		 C[5] = 8.375; 
 		 C[6] = 49.475; 
 		 C[7] = 34.425; 
 		 C[8] = 0.45; 
	 } 
	 if (c == 1)   { 
 		 C[1] = 24.8; 
 		 C[2] = 32.8; 
 		 C[3] = 2.46; 
 		 C[4] = 6.425; 
 		 C[5] = 8.675; 
 		 C[6] = 21.825; 
 		 C[7] = 40.025; 
 		 C[8] = 0.354; 
	 } 
	 if (c == 2)   { 
 		 C[1] = 28; 
 		 C[2] = 42.4; 
 		 C[3] = 4.62; 
 		 C[4] = 17.975; 
 		 C[5] = 12.275; 
 		 C[6] = 46.325; 
 		 C[7] = 42.825; 
 		 C[8] = 0.178; 
	 } 
	 if (c == 3)   { 
 		 C[1] = 20; 
 		 C[2] = 47.2; 
 		 C[3] = 5.02; 
 		 C[4] = 10.025; 
 		 C[5] = 8.975; 
 		 C[6] = 43.875; 
 		 C[7] = 20.075; 
 		 C[8] = 0.442; 
	 } 
	 if (c == 4)   { 
 		 C[1] = 22; 
 		 C[2] = 77.6; 
 		 C[3] = 2.5; 
 		 C[4] = 7.025; 
 		 C[5] = 16.775; 
 		 C[6] = 23.575; 
 		 C[7] = 21.125; 
 		 C[8] = 0.426; 
	 } 
	 if (c == 5)   { 
 		 C[1] = 18.4; 
 		 C[2] = 68; 
 		 C[3] = 4.18; 
 		 C[4] = 15.725; 
 		 C[5] = 12.425; 
 		 C[6] = 16.925; 
 		 C[7] = 47.375; 
 		 C[8] = 0.262; 
	 } 
	 if (c == 6)   { 
 		 C[1] = 13.6; 
 		 C[2] = 44; 
 		 C[3] = 5.66; 
 		 C[4] = 8.525; 
 		 C[5] = 13.175; 
 		 C[6] = 15.175; 
 		 C[7] = 22.175; 
 		 C[8] = 0.19; 
	 } 
	 if (c == 7)   { 
 		 C[1] = 8; 
 		 C[2] = 48.8; 
 		 C[3] = 5.94; 
 		 C[4] = 6.125; 
 		 C[5] = 5.375; 
 		 C[6] = 44.925; 
 		 C[7] = 21.825; 
 		 C[8] = 0.21; 
	 } 
	 if (c == 8)   { 
 		 C[1] = 28.4; 
 		 C[2] = 36; 
 		 C[3] = 2.66; 
 		 C[4] = 13.925; 
 		 C[5] = 11.525; 
 		 C[6] = 19.725; 
 		 C[7] = 33.725; 
 		 C[8] = 0.378; 
	 } 
	 if (c == 9)   { 
 		 C[1] = 20.8; 
 		 C[2] = 50.4; 
 		 C[3] = 4.86; 
 		 C[4] = 17.375; 
 		 C[5] = 14.225; 
 		 C[6] = 27.425; 
 		 C[7] = 30.225; 
 		 C[8] = 0.422; 
	 } 
	 if (c == 10)   { 
 		 C[1] = 27.2; 
 		 C[2] = 83.2; 
 		 C[3] = 4.54; 
 		 C[4] = 10.175; 
 		 C[5] = 11.375; 
 		 C[6] = 38.275; 
 		 C[7] = 21.475; 
 		 C[8] = 0.478; 
	 } 
	 if (c == 11)   { 
 		 C[1] = 32.4; 
 		 C[2] = 48; 
 		 C[3] = 3.86; 
 		 C[4] = 8.075; 
 		 C[5] = 7.175; 
 		 C[6] = 42.825; 
 		 C[7] = 16.575; 
 		 C[8] = 0.222; 
	 } 
	 if (c == 12)   { 
 		 C[1] = 29.2; 
 		 C[2] = 18.4; 
 		 C[3] = 5.5; 
 		 C[4] = 8.825; 
 		 C[5] = 10.325; 
 		 C[6] = 33.375; 
 		 C[7] = 33.375; 
 		 C[8] = 0.154; 
	 } 
	 if (c == 13)   { 
 		 C[1] = 42; 
 		 C[2] = 43.2; 
 		 C[3] = 4.06; 
 		 C[4] = 18.275; 
 		 C[5] = 16.475; 
 		 C[6] = 21.125; 
 		 C[7] = 25.325; 
 		 C[8] = 0.194; 
	 } 
	 if (c == 14)   { 
 		 C[1] = 44.4; 
 		 C[2] = 66.4; 
 		 C[3] = 2.94; 
 		 C[4] = 9.425; 
 		 C[5] = 9.575; 
 		 C[6] = 22.875; 
 		 C[7] = 45.275; 
 		 C[8] = 0.462; 
	 } 
	 if (c == 15)   { 
 		 C[1] = 11.6; 
 		 C[2] = 33.6; 
 		 C[3] = 5.18; 
 		 C[4] = 7.475; 
 		 C[5] = 14.825; 
 		 C[6] = 35.825; 
 		 C[7] = 24.625; 
 		 C[8] = 0.286; 
	 } 
	 if (c == 16)   { 
 		 C[1] = 37.2; 
 		 C[2] = 72; 
 		 C[3] = 2.22; 
 		 C[4] = 11.975; 
 		 C[5] = 8.525; 
 		 C[6] = 17.975; 
 		 C[7] = 30.925; 
 		 C[8] = 0.218; 
	 } 
	 if (c == 17)   { 
 		 C[1] = 15.6; 
 		 C[2] = 12.8; 
 		 C[3] = 5.26; 
 		 C[4] = 13.625; 
 		 C[5] = 8.075; 
 		 C[6] = 26.025; 
 		 C[7] = 47.725; 
 		 C[8] = 0.102; 
	 } 
	 if (c == 18)   { 
 		 C[1] = 42.4; 
 		 C[2] = 88; 
 		 C[3] = 3.58; 
 		 C[4] = 8.225; 
 		 C[5] = 9.875; 
 		 C[6] = 40.725; 
 		 C[7] = 19.725; 
 		 C[8] = 0.25; 
	 } 
	 if (c == 19)   { 
 		 C[1] = 23.2; 
 		 C[2] = 11.2; 
 		 C[3] = 2.14; 
 		 C[4] = 5.525; 
 		 C[5] = 15.425; 
 		 C[6] = 45.625; 
 		 C[7] = 22.525; 
 		 C[8] = 0.15; 
	 } 
	 if (c == 20)   { 
 		 C[1] = 13.2; 
 		 C[2] = 32; 
 		 C[3] = 3.7; 
 		 C[4] = 5.075; 
 		 C[5] = 17.375; 
 		 C[6] = 23.225; 
 		 C[7] = 37.225; 
 		 C[8] = 0.342; 
	 } 
	 if (c == 21)   { 
 		 C[1] = 14; 
 		 C[2] = 28; 
 		 C[3] = 5.78; 
 		 C[4] = 17.675; 
 		 C[5] = 17.225; 
 		 C[6] = 19.375; 
 		 C[7] = 35.825; 
 		 C[8] = 0.13; 
	 } 
	 if (c == 22)   { 
 		 C[1] = 18.8; 
 		 C[2] = 74.4; 
 		 C[3] = 3.54; 
 		 C[4] = 9.125; 
 		 C[5] = 10.775; 
 		 C[6] = 31.975; 
 		 C[7] = 17.275; 
 		 C[8] = 0.35; 
	 } 
	 if (c == 23)   { 
 		 C[1] = 7.2; 
 		 C[2] = 28.8; 
 		 C[3] = 2.18; 
 		 C[4] = 16.175; 
 		 C[5] = 5.525; 
 		 C[6] = 31.625; 
 		 C[7] = 27.425; 
 		 C[8] = 0.138; 
	 } 
	 if (c == 24)   { 
 		 C[1] = 19.2; 
 		 C[2] = 21.6; 
 		 C[3] = 4.14; 
 		 C[4] = 10.625; 
 		 C[5] = 19.925; 
 		 C[6] = 24.975; 
 		 C[7] = 47.025; 
 		 C[8] = 0.414; 
	 } 
	 if (c == 25)   { 
 		 C[1] = 10; 
 		 C[2] = 44.8; 
 		 C[3] = 3.9; 
 		 C[4] = 11.825; 
 		 C[5] = 9.125; 
 		 C[6] = 46.675; 
 		 C[7] = 48.075; 
 		 C[8] = 0.294; 
	 } 
	 if (c == 26)   { 
 		 C[1] = 26.8; 
 		 C[2] = 71.2; 
 		 C[3] = 3.34; 
 		 C[4] = 13.025; 
 		 C[5] = 12.575; 
 		 C[6] = 26.375; 
 		 C[7] = 41.075; 
 		 C[8] = 0.214; 
	 } 
	 if (c == 27)   { 
 		 C[1] = 8.4; 
 		 C[2] = 64; 
 		 C[3] = 2.82; 
 		 C[4] = 11.225; 
 		 C[5] = 6.575; 
 		 C[6] = 35.125; 
 		 C[7] = 29.175; 
 		 C[8] = 0.258; 
	 } 
	 if (c == 28)   { 
 		 C[1] = 7.6; 
 		 C[2] = 39.2; 
 		 C[3] = 4.66; 
 		 C[4] = 16.625; 
 		 C[5] = 11.075; 
 		 C[6] = 41.075; 
 		 C[7] = 27.775; 
 		 C[8] = 0.118; 
	 } 
	 if (c == 29)   { 
 		 C[1] = 30.4; 
 		 C[2] = 76.8; 
 		 C[3] = 2.02; 
 		 C[4] = 14.075; 
 		 C[5] = 12.125; 
 		 C[6] = 37.925; 
 		 C[7] = 17.625; 
 		 C[8] = 0.23; 
	 } 
	 if (c == 30)   { 
 		 C[1] = 16.4; 
 		 C[2] = 17.6; 
 		 C[3] = 4.26; 
 		 C[4] = 10.775; 
 		 C[5] = 10.925; 
 		 C[6] = 30.575; 
 		 C[7] = 34.775; 
 		 C[8] = 0.266; 
	 } 
	 if (c == 31)   { 
 		 C[1] = 31.2; 
 		 C[2] = 69.6; 
 		 C[3] = 3.62; 
 		 C[4] = 18.125; 
 		 C[5] = 11.675; 
 		 C[6] = 24.625; 
 		 C[7] = 34.075; 
 		 C[8] = 0.446; 
	 } 
	 if (c == 32)   { 
 		 C[1] = 40; 
 		 C[2] = 79.2; 
 		 C[3] = 4.5; 
 		 C[4] = 14.225; 
 		 C[5] = 8.225; 
 		 C[6] = 29.875; 
 		 C[7] = 48.775; 
 		 C[8] = 0.394; 
	 } 
	 if (c == 33)   { 
 		 C[1] = 26; 
 		 C[2] = 26.4; 
 		 C[3] = 2.3; 
 		 C[4] = 7.175; 
 		 C[5] = 10.175; 
 		 C[6] = 37.225; 
 		 C[7] = 37.575; 
 		 C[8] = 0.358; 
	 } 
	 if (c == 34)   { 
 		 C[1] = 44; 
 		 C[2] = 84.8; 
 		 C[3] = 5.62; 
 		 C[4] = 15.275; 
 		 C[5] = 10.475; 
 		 C[6] = 26.725; 
 		 C[7] = 35.475; 
 		 C[8] = 0.41; 
	 } 
	 if (c == 35)   { 
 		 C[1] = 37.6; 
 		 C[2] = 49.6; 
 		 C[3] = 4.1; 
 		 C[4] = 16.925; 
 		 C[5] = 17.075; 
 		 C[6] = 31.275; 
 		 C[7] = 42.125; 
 		 C[8] = 0.314; 
	 } 
	 if (c == 36)   { 
 		 C[1] = 31.6; 
 		 C[2] = 56; 
 		 C[3] = 4.22; 
 		 C[4] = 18.875; 
 		 C[5] = 14.975; 
 		 C[6] = 20.425; 
 		 C[7] = 30.575; 
 		 C[8] = 0.242; 
	 } 
	 if (c == 37)   { 
 		 C[1] = 21.6; 
 		 C[2] = 70.4; 
 		 C[3] = 3.78; 
 		 C[4] = 15.125; 
 		 C[5] = 16.025; 
 		 C[6] = 20.075; 
 		 C[7] = 36.175; 
 		 C[8] = 0.494; 
	 } 
	 if (c == 38)   { 
 		 C[1] = 9.2; 
 		 C[2] = 46.4; 
 		 C[3] = 4.02; 
 		 C[4] = 17.825; 
 		 C[5] = 7.475; 
 		 C[6] = 25.325; 
 		 C[7] = 19.025; 
 		 C[8] = 0.466; 
	 } 
	 if (c == 39)   { 
 		 C[1] = 35.6; 
 		 C[2] = 23.2; 
 		 C[3] = 4.38; 
 		 C[4] = 10.475; 
 		 C[5] = 5.825; 
 		 C[6] = 20.775; 
 		 C[7] = 44.225; 
 		 C[8] = 0.298; 
	 } 
	 if (c == 40)   { 
 		 C[1] = 25.2; 
 		 C[2] = 62.4; 
 		 C[3] = 2.74; 
 		 C[4] = 14.825; 
 		 C[5] = 18.275; 
 		 C[6] = 48.075; 
 		 C[7] = 15.525; 
 		 C[8] = 0.402; 
	 } 
	 if (c == 41)   { 
 		 C[1] = 27.6; 
 		 C[2] = 55.2; 
 		 C[3] = 4.82; 
 		 C[4] = 6.275; 
 		 C[5] = 15.275; 
 		 C[6] = 34.075; 
 		 C[7] = 26.025; 
 		 C[8] = 0.382; 
	 } 
	 if (c == 42)   { 
 		 C[1] = 34; 
 		 C[2] = 57.6; 
 		 C[3] = 3.98; 
 		 C[4] = 19.625; 
 		 C[5] = 7.625; 
 		 C[6] = 23.925; 
 		 C[7] = 33.025; 
 		 C[8] = 0.366; 
	 } 
	 if (c == 43)   { 
 		 C[1] = 12.4; 
 		 C[2] = 54.4; 
 		 C[3] = 5.22; 
 		 C[4] = 9.275; 
 		 C[5] = 12.725; 
 		 C[6] = 22.525; 
 		 C[7] = 23.225; 
 		 C[8] = 0.182; 
	 } 
	 if (c == 44)   { 
 		 C[1] = 34.4; 
 		 C[2] = 16.8; 
 		 C[3] = 3.02; 
 		 C[4] = 13.325; 
 		 C[5] = 10.025; 
 		 C[6] = 19.025; 
 		 C[7] = 18.325; 
 		 C[8] = 0.238; 
	 } 
	 if (c == 45)   { 
 		 C[1] = 41.2; 
 		 C[2] = 81.6; 
 		 C[3] = 2.54; 
 		 C[4] = 10.325; 
 		 C[5] = 14.375; 
 		 C[6] = 39.325; 
 		 C[7] = 28.825; 
 		 C[8] = 0.43; 
	 } 
	 if (c == 46)   { 
 		 C[1] = 23.6; 
 		 C[2] = 40.8; 
 		 C[3] = 4.9; 
 		 C[4] = 14.675; 
 		 C[5] = 18.425; 
 		 C[6] = 28.475; 
 		 C[7] = 27.075; 
 		 C[8] = 0.37; 
	 } 
	 if (c == 47)   { 
 		 C[1] = 40.4; 
 		 C[2] = 20; 
 		 C[3] = 5.86; 
 		 C[4] = 16.475; 
 		 C[5] = 5.975; 
 		 C[6] = 33.025; 
 		 C[7] = 26.725; 
 		 C[8] = 0.282; 
	 } 
	 if (c == 48)   { 
 		 C[1] = 39.6; 
 		 C[2] = 24; 
 		 C[3] = 3.18; 
 		 C[4] = 7.775; 
 		 C[5] = 15.725; 
 		 C[6] = 43.175; 
 		 C[7] = 25.675; 
 		 C[8] = 0.438; 
	 } 
	 if (c == 49)   { 
 		 C[1] = 10.4; 
 		 C[2] = 40; 
 		 C[3] = 4.58; 
 		 C[4] = 17.225; 
 		 C[5] = 13.625; 
 		 C[6] = 27.075; 
 		 C[7] = 31.275; 
 		 C[8] = 0.306; 
	 } 
	 if (c == 50)   { 
 		 C[1] = 6; 
 		 C[2] = 89.6; 
 		 C[3] = 3.5; 
 		 C[4] = 14.525; 
 		 C[5] = 15.125; 
 		 C[6] = 30.225; 
 		 C[7] = 16.225; 
 		 C[8] = 0.362; 
	 } 
	 if (c == 51)   { 
 		 C[1] = 38; 
 		 C[2] = 25.6; 
 		 C[3] = 5.9; 
 		 C[4] = 5.675; 
 		 C[5] = 7.775; 
 		 C[6] = 15.525; 
 		 C[7] = 31.625; 
 		 C[8] = 0.29; 
	 } 
	 if (c == 52)   { 
 		 C[1] = 14.4; 
 		 C[2] = 78.4; 
 		 C[3] = 2.38; 
 		 C[4] = 14.975; 
 		 C[5] = 7.325; 
 		 C[6] = 34.775; 
 		 C[7] = 38.275; 
 		 C[8] = 0.47; 
	 } 
	 if (c == 53)   { 
 		 C[1] = 19.6; 
 		 C[2] = 19.2; 
 		 C[3] = 3.14; 
 		 C[4] = 12.725; 
 		 C[5] = 14.075; 
 		 C[6] = 17.625; 
 		 C[7] = 23.575; 
 		 C[8] = 0.498; 
	 } 
	 if (c == 54)   { 
 		 C[1] = 21.2; 
 		 C[2] = 16; 
 		 C[3] = 2.86; 
 		 C[4] = 7.625; 
 		 C[5] = 17.675; 
 		 C[6] = 42.475; 
 		 C[7] = 43.525; 
 		 C[8] = 0.198; 
	 } 
	 if (c == 55)   { 
 		 C[1] = 36.4; 
 		 C[2] = 12; 
 		 C[3] = 4.42; 
 		 C[4] = 18.425; 
 		 C[5] = 13.325; 
 		 C[6] = 18.325; 
 		 C[7] = 36.525; 
 		 C[8] = 0.17; 
	 } 
	 if (c == 56)   { 
 		 C[1] = 12; 
 		 C[2] = 86.4; 
 		 C[3] = 2.78; 
 		 C[4] = 6.875; 
 		 C[5] = 5.225; 
 		 C[6] = 47.375; 
 		 C[7] = 29.875; 
 		 C[8] = 0.142; 
	 } 
	 if (c == 57)   { 
 		 C[1] = 40.8; 
 		 C[2] = 52.8; 
 		 C[3] = 5.14; 
 		 C[4] = 16.025; 
 		 C[5] = 7.925; 
 		 C[6] = 38.975; 
 		 C[7] = 40.725; 
 		 C[8] = 0.146; 
	 } 
	 if (c == 58)   { 
 		 C[1] = 43.2; 
 		 C[2] = 59.2; 
 		 C[3] = 3.26; 
 		 C[4] = 17.075; 
 		 C[5] = 18.725; 
 		 C[6] = 49.125; 
 		 C[7] = 18.675; 
 		 C[8] = 0.202; 
	 } 
	 if (c == 59)   { 
 		 C[1] = 44.8; 
 		 C[2] = 35.2; 
 		 C[3] = 5.38; 
 		 C[4] = 19.025; 
 		 C[5] = 18.125; 
 		 C[6] = 39.675; 
 		 C[7] = 24.275; 
 		 C[8] = 0.39; 
	 } 
	 if (c == 60)   { 
 		 C[1] = 14.8; 
 		 C[2] = 73.6; 
 		 C[3] = 4.7; 
 		 C[4] = 7.325; 
 		 C[5] = 17.825; 
 		 C[6] = 29.525; 
 		 C[7] = 49.125; 
 		 C[8] = 0.226; 
	 } 
	 if (c == 61)   { 
 		 C[1] = 24.4; 
 		 C[2] = 82.4; 
 		 C[3] = 3.22; 
 		 C[4] = 7.925; 
 		 C[5] = 10.625; 
 		 C[6] = 49.825; 
 		 C[7] = 45.625; 
 		 C[8] = 0.11; 
	 } 
	 if (c == 62)   { 
 		 C[1] = 20.4; 
 		 C[2] = 56.8; 
 		 C[3] = 3.66; 
 		 C[4] = 18.575; 
 		 C[5] = 16.625; 
 		 C[6] = 25.675; 
 		 C[7] = 29.525; 
 		 C[8] = 0.254; 
	 } 
	 if (c == 63)   { 
 		 C[1] = 22.4; 
 		 C[2] = 58.4; 
 		 C[3] = 5.34; 
 		 C[4] = 11.075; 
 		 C[5] = 19.625; 
 		 C[6] = 41.425; 
 		 C[7] = 41.425; 
 		 C[8] = 0.322; 
	 } 
	 if (c == 64)   { 
 		 C[1] = 33.2; 
 		 C[2] = 30.4; 
 		 C[3] = 5.1; 
 		 C[4] = 14.375; 
 		 C[5] = 9.425; 
 		 C[6] = 32.325; 
 		 C[7] = 43.875; 
 		 C[8] = 0.434; 
	 } 
	 if (c == 65)   { 
 		 C[1] = 15.2; 
 		 C[2] = 63.2; 
 		 C[3] = 3.3; 
 		 C[4] = 13.175; 
 		 C[5] = 13.475; 
 		 C[6] = 35.475; 
 		 C[7] = 46.675; 
 		 C[8] = 0.406; 
	 } 
	 if (c == 66)   { 
 		 C[1] = 6.8; 
 		 C[2] = 15.2; 
 		 C[3] = 5.82; 
 		 C[4] = 11.375; 
 		 C[5] = 8.825; 
 		 C[6] = 29.175; 
 		 C[7] = 43.175; 
 		 C[8] = 0.31; 
	 } 
	 if (c == 67)   { 
 		 C[1] = 29.6; 
 		 C[2] = 75.2; 
 		 C[3] = 5.46; 
 		 C[4] = 5.825; 
 		 C[5] = 14.675; 
 		 C[6] = 28.825; 
 		 C[7] = 39.325; 
 		 C[8] = 0.166; 
	 } 
	 if (c == 68)   { 
 		 C[1] = 22.8; 
 		 C[2] = 64.8; 
 		 C[3] = 2.42; 
 		 C[4] = 8.675; 
 		 C[5] = 19.775; 
 		 C[6] = 43.525; 
 		 C[7] = 48.425; 
 		 C[8] = 0.33; 
	 } 
	 if (c == 69)   { 
 		 C[1] = 18; 
 		 C[2] = 20.8; 
 		 C[3] = 5.06; 
 		 C[4] = 5.975; 
 		 C[5] = 12.875; 
 		 C[6] = 17.275; 
 		 C[7] = 24.975; 
 		 C[8] = 0.274; 
	 } 
	 if (c == 70)   { 
 		 C[1] = 30.8; 
 		 C[2] = 88.8; 
 		 C[3] = 2.26; 
 		 C[4] = 19.925; 
 		 C[5] = 17.525; 
 		 C[6] = 36.875; 
 		 C[7] = 20.425; 
 		 C[8] = 0.106; 
	 } 
	 if (c == 71)   { 
 		 C[1] = 26.4; 
 		 C[2] = 14.4; 
 		 C[3] = 2.34; 
 		 C[4] = 6.725; 
 		 C[5] = 6.275; 
 		 C[6] = 44.575; 
 		 C[7] = 38.975; 
 		 C[8] = 0.318; 
	 } 
	 if (c == 72)   { 
 		 C[1] = 11.2; 
 		 C[2] = 85.6; 
 		 C[3] = 3.74; 
 		 C[4] = 11.675; 
 		 C[5] = 17.975; 
 		 C[6] = 16.225; 
 		 C[7] = 44.575; 
 		 C[8] = 0.326; 
	 } 
	 if (c == 73)   { 
 		 C[1] = 33.6; 
 		 C[2] = 76; 
 		 C[3] = 2.1; 
 		 C[4] = 9.575; 
 		 C[5] = 11.225; 
 		 C[6] = 16.575; 
 		 C[7] = 39.675; 
 		 C[8] = 0.302; 
	 } 
	 if (c == 74)   { 
 		 C[1] = 9.6; 
 		 C[2] = 22.4; 
 		 C[3] = 2.7; 
 		 C[4] = 9.875; 
 		 C[5] = 6.425; 
 		 C[6] = 21.475; 
 		 C[7] = 40.375; 
 		 C[8] = 0.134; 
	 } 
	 if (c == 75)   { 
 		 C[1] = 35.2; 
 		 C[2] = 53.6; 
 		 C[3] = 4.74; 
 		 C[4] = 10.925; 
 		 C[5] = 19.325; 
 		 C[6] = 47.725; 
 		 C[7] = 31.975; 
 		 C[8] = 0.278; 
	 } 
	 if (c == 76)   { 
 		 C[1] = 5.2; 
 		 C[2] = 13.6; 
 		 C[3] = 5.58; 
 		 C[4] = 19.775; 
 		 C[5] = 13.775; 
 		 C[6] = 30.925; 
 		 C[7] = 42.475; 
 		 C[8] = 0.386; 
	 } 
	 if (c == 77)   { 
 		 C[1] = 38.4; 
 		 C[2] = 80; 
 		 C[3] = 3.94; 
 		 C[4] = 19.175; 
 		 C[5] = 14.525; 
 		 C[6] = 18.675; 
 		 C[7] = 16.925; 
 		 C[8] = 0.474; 
	 } 
	 if (c == 78)   { 
 		 C[1] = 38.8; 
 		 C[2] = 67.2; 
 		 C[3] = 3.82; 
 		 C[4] = 13.775; 
 		 C[5] = 9.725; 
 		 C[6] = 34.425; 
 		 C[7] = 41.775; 
 		 C[8] = 0.206; 
	 } 
	 if (c == 79)   { 
 		 C[1] = 41.6; 
 		 C[2] = 34.4; 
 		 C[3] = 5.3; 
 		 C[4] = 15.875; 
 		 C[5] = 19.475; 
 		 C[6] = 47.025; 
 		 C[7] = 32.675; 
 		 C[8] = 0.346; 
	 } 
	 if (c == 80)   { 
 		 C[1] = 32; 
 		 C[2] = 60; 
 		 C[3] = 3.46; 
 		 C[4] = 19.325; 
 		 C[5] = 13.025; 
 		 C[6] = 27.775; 
 		 C[7] = 28.475; 
 		 C[8] = 0.482; 
	 } 
	 if (c == 81)   { 
 		 C[1] = 17.2; 
 		 C[2] = 61.6; 
 		 C[3] = 2.58; 
 		 C[4] = 19.475; 
 		 C[5] = 6.875; 
 		 C[6] = 15.875; 
 		 C[7] = 15.875; 
 		 C[8] = 0.374; 
	 } 
	 if (c == 82)   { 
 		 C[1] = 36; 
 		 C[2] = 72.8; 
 		 C[3] = 2.62; 
 		 C[4] = 15.575; 
 		 C[5] = 19.175; 
 		 C[6] = 22.175; 
 		 C[7] = 28.125; 
 		 C[8] = 0.114; 
	 } 
	 if (c == 83)   { 
 		 C[1] = 16; 
 		 C[2] = 87.2; 
 		 C[3] = 5.42; 
 		 C[4] = 5.375; 
 		 C[5] = 18.875; 
 		 C[6] = 24.275; 
 		 C[7] = 36.875; 
 		 C[8] = 0.234; 
	 } 
	 if (c == 84)   { 
 		 C[1] = 6.4; 
 		 C[2] = 84; 
 		 C[3] = 2.98; 
 		 C[4] = 11.525; 
 		 C[5] = 5.675; 
 		 C[6] = 28.125; 
 		 C[7] = 15.175; 
 		 C[8] = 0.122; 
	 } 
	 if (c == 85)   { 
 		 C[1] = 32.8; 
 		 C[2] = 52; 
 		 C[3] = 3.38; 
 		 C[4] = 18.725; 
 		 C[5] = 5.075; 
 		 C[6] = 36.525; 
 		 C[7] = 37.925; 
 		 C[8] = 0.454; 
	 } 
	 if (c == 86)   { 
 		 C[1] = 17.6; 
 		 C[2] = 45.6; 
 		 C[3] = 5.7; 
 		 C[4] = 16.775; 
 		 C[5] = 16.325; 
 		 C[6] = 32.675; 
 		 C[7] = 19.375; 
 		 C[8] = 0.398; 
	 } 
	 if (c == 87)   { 
 		 C[1] = 42.8; 
 		 C[2] = 10.4; 
 		 C[3] = 5.54; 
 		 C[4] = 8.975; 
 		 C[5] = 18.575; 
 		 C[6] = 45.275; 
 		 C[7] = 44.925; 
 		 C[8] = 0.162; 
	 } 
	 if (c == 88)   { 
 		 C[1] = 10.8; 
 		 C[2] = 27.2; 
 		 C[3] = 4.3; 
 		 C[4] = 5.225; 
 		 C[5] = 19.025; 
 		 C[6] = 42.125; 
 		 C[7] = 23.925; 
 		 C[8] = 0.174; 
	 } 
	 if (c == 89)   { 
 		 C[1] = 34.8; 
 		 C[2] = 37.6; 
 		 C[3] = 3.42; 
 		 C[4] = 12.275; 
 		 C[5] = 15.575; 
 		 C[6] = 37.575; 
 		 C[7] = 20.775; 
 		 C[8] = 0.158; 
	 } 
	 if (c == 90)   { 
 		 C[1] = 5.6; 
 		 C[2] = 41.6; 
 		 C[3] = 3.06; 
 		 C[4] = 12.875; 
 		 C[5] = 11.975; 
 		 C[6] = 44.225; 
 		 C[7] = 49.475; 
 		 C[8] = 0.49; 
	 } 
	 if (c == 91)   { 
 		 C[1] = 12.8; 
 		 C[2] = 31.2; 
 		 C[3] = 4.34; 
 		 C[4] = 12.425; 
 		 C[5] = 11.825; 
 		 C[6] = 38.625; 
 		 C[7] = 17.975; 
 		 C[8] = 0.486; 
	 } 
	 if (c == 92)   { 
 		 C[1] = 43.6; 
 		 C[2] = 80.8; 
 		 C[3] = 4.46; 
 		 C[4] = 12.575; 
 		 C[5] = 9.275; 
 		 C[6] = 48.775; 
 		 C[7] = 45.975; 
 		 C[8] = 0.458; 
	 } 
	 if (c == 93)   { 
 		 C[1] = 16.8; 
 		 C[2] = 38.4; 
 		 C[3] = 5.74; 
 		 C[4] = 16.325; 
 		 C[5] = 16.175; 
 		 C[6] = 40.375; 
 		 C[7] = 22.875; 
 		 C[8] = 0.186; 
	 } 
	 if (c == 94)   { 
 		 C[1] = 25.6; 
 		 C[2] = 60.8; 
 		 C[3] = 5.98; 
 		 C[4] = 13.475; 
 		 C[5] = 16.925; 
 		 C[6] = 41.775; 
 		 C[7] = 35.125; 
 		 C[8] = 0.27; 
	 } 
	 if (c == 95)   { 
 		 C[1] = 24; 
 		 C[2] = 36.8; 
 		 C[3] = 4.78; 
 		 C[4] = 8.375; 
 		 C[5] = 7.025; 
 		 C[6] = 48.425; 
 		 C[7] = 46.325; 
 		 C[8] = 0.418; 
	 } 
	 if (c == 96)   { 
 		 C[1] = 36.8; 
 		 C[2] = 24.8; 
 		 C[3] = 2.9; 
 		 C[4] = 15.425; 
 		 C[5] = 13.925; 
 		 C[6] = 45.975; 
 		 C[7] = 38.625; 
 		 C[8] = 0.246; 
	 } 
	 if (c == 97)   { 
 		 C[1] = 30; 
 		 C[2] = 68.8; 
 		 C[3] = 4.94; 
 		 C[4] = 6.575; 
 		 C[5] = 15.875; 
 		 C[6] = 40.025; 
 		 C[7] = 49.825; 
 		 C[8] = 0.334; 
	 } 
	 if (c == 98)   { 
 		 C[1] = 8.8; 
 		 C[2] = 51.2; 
 		 C[3] = 2.06; 
 		 C[4] = 17.525; 
 		 C[5] = 6.725; 
 		 C[6] = 36.175; 
 		 C[7] = 32.325; 
 		 C[8] = 0.126; 
	 } 
	 if (c == 99)   { 
 		 C[1] = 28.8; 
 		 C[2] = 65.6; 
 		 C[3] = 3.1; 
 		 C[4] = 9.725; 
 		 C[5] = 6.125; 
 		 C[6] = 33.725; 
 		 C[7] = 26.375; 
 		 C[8] = 0.338; 
	 } 
 } /*  End of update_variables_lhs  */ 


static int nfigsloaded; 
int load_data_figures(double FIGS[][MAX_FIGS], eqfig figdata[], int nfigs, int jj, double y[], double C[], double AUX[], double x, FILE * myfile) { 
	 int j = nfigsloaded; 
	 int i; int errorover=0; 
		  FIGS[0][j] = x; 
		  if (! finite(AUX[1])) { printf("Overflow error on variable trucks_in \n"); errorover++; } 
		  FIGS[1][j] = AUX[1];
		  if (figdata[1].max < FIGS[1][j]) { figdata[1].max =  FIGS[1][j]; } 
		  if (figdata[1].min > FIGS[1][j]) { figdata[1].min =  FIGS[1][j]; } 
		  if (! finite(AUX[2])) { printf("Overflow error on variable queue_line_a \n"); errorover++; } 
		  FIGS[2][j] = AUX[2];
		  if (figdata[2].max < FIGS[2][j]) { figdata[2].max =  FIGS[2][j]; } 
		  if (figdata[2].min > FIGS[2][j]) { figdata[2].min =  FIGS[2][j]; } 
		  if (! finite(AUX[3])) { printf("Overflow error on variable queue_line_b \n"); errorover++; } 
		  FIGS[3][j] = AUX[3];
		  if (figdata[3].max < FIGS[3][j]) { figdata[3].max =  FIGS[3][j]; } 
		  if (figdata[3].min > FIGS[3][j]) { figdata[3].min =  FIGS[3][j]; } 
	 nfigsloaded ++;
	 if (nfigsloaded >= MAX_FIGS ) { int xx, yy; 
		 for (xx=0;xx<MAX_FIGS;xx++) { 
		 fprintf(myfile,"%f\t",FIGS[0][xx]); 
		  for (yy=1;yy<=3;yy++) 
			  fprintf(myfile, "%.6e\t",FIGS[yy][xx]); 
		 fprintf(myfile,"\n"); 
} nfigsloaded =0; } 
 return errorover; 
} 


int main (void) 
{ 
	 time_t init_time=time(NULL), end_time; double mydifftime;
	 int i,j, resode=0;  int myc=0; 
	 double h, x=1.0, *y, *dydx, *yout, *C, *AUX; 
	 FILE *stream; 
	 char filename[5]; 
	 int nfigs = 3;
	 eqfig figdata[5];
	 double FIGS[5][MAX_FIGS]; 
	 int maxloop =0, nloop =0; int figres=0; 
	 y    =  dvector(1,N);  
	 dydx =  dvector(1,N); 
	 yout =  dvector(1,N);  
	 C   =   dvector(1,NINC); 
	 AUX =   dvector(1,N); 
	 nfigsloaded = 0; 
	 for(i=1;i<=nfigs;i++) { figdata[i].max = -HUGE_VAL; figdata[i].min=HUGE_VAL; }; 
	  strcpy(figdata[1].name,"trucks_in");
	  strcpy(figdata[2].name,"queue_line_a");
	  strcpy(figdata[3].name,"queue_line_b");
	 while (myc < 100) { 
	 load_constants(C); 
	 update_variables_lhs(myc, C); 
	 load_auxlevel(AUX,y,C); 
	 nfigsloaded = 0; 
	 /* ---rk4--- */ 
	 h = (double)0.1;
	 x = (double)0; 
	 maxloop = (int) (3600/h)+1;
	 nloop = 0; 
	 j=0; 
	 printf("Solving run %d \n", myc+1);
	 sprintf(filename, "%04u", myc+1); 
	 stream = fopen(filename,"w"  ); 
	 while(nloop <= maxloop) {
		 if (nloop % (int)ceil(1/h) == 0) {
		 resode=load_data_figures(FIGS, figdata, nfigs, j, y, C, AUX, x,  stream);
		 if (resode > 0) break; 
			 j++; }  
		 derivs(x,y,dydx,C, AUX); 
		 rk4(y,dydx,N,x,h,yout,derivs, C, AUX); 
		 for(i=0; i<N; i++) 
		 y[i] = yout[i]; 
		 nloop++; 
		 x = x + h;
	 }  
	for(i=0; i<nfigsloaded; i++) { 
		 fprintf(stream,"%f\t",FIGS[0][i]);
		 for(j=1; j<=nfigs; j++) fprintf(stream,"%.5e\t",FIGS[j][i]); 
		 fprintf(stream,"\n"); }; 
		 fclose(stream); 
	 if (resode > 0) { printf( "Error solving run %d \n", myc+1); break;	} 
	 myc++; } 
	 WritePlotScript(1, nfigs, 4320, figdata, 0, myc-1);
	 myreturnsyscall = system("rm output1.pdf; gnuplot plot.scr &"); 
	 free_dvector(yout,1,N); 
	 free_dvector(dydx,1,N); 
	 free_dvector(y,1,N); 
	 free_dvector(C,1,NINC); 
	 free_dvector(AUX,1,N); 
	 end_time = time(NULL); 
	 mydifftime = difftime(end_time, init_time); 
	 printf("##  %f seconds \n",mydifftime); 
	 return 0; 
} 
