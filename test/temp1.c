/*  Program generated by teval1, a translator and LHS/PRCC evaluator written by Jose L. Segovia,  2002-03, for the Kirschner Lab.  */ 
#include <stdio.h> 
#include <stdlib.h> 
#include <math.h>  
#include <time.h>  
#include <string.h> 
#include "datatype.h"
#define NRANSI 
#include "my_nr.h"
#include "nrutil.h"
double dxsav,*xp,**py;  /* defining declarations */ 
int kmax,kount; 
int nrhs;   /* counts function evaluations */ 
#define NINC 11
#define N 5
#define NFigs 5
	 int myreturnsyscall = 0;

void derivs(double TimeAct, double y[], double dydx[], double C[], double AUX[]) 
{
	nrhs++; 
	AUX[1]=  C[9];  		 /* trucks_in=w1; */
	AUX[2]=  C[9];  		 /* queue_line_a=w1; */
	AUX[3]=  C[9];  		 /* queue_line_b=w1; */
}
void load_constants(double C[]) {  
	 /* Filling initial conditions */ 
	 C[1] =  10 ; 		 /* trucks_init=10 5 10 15 $U ; */
	 C[2] =  50 ; 		 /* percentage_dis=50 30 50 90 $U ; */
	 C[3] =  2 ; 		 /* distance_speed=2 2 6 10 $U ; */
	 C[4] =  10 ; 		 /* flow_left=10 10 50 100 $U ; */
	 C[5] =  10 ; 		 /* flow_right=10 10 50 100 $U ; */
	 C[6] =  20 ; 		 /* flow_up=20 20 75 150 $U ; */
	 C[7] =  20 ; 		 /* flow_down=20 20 75 150 $U ; */
	 C[8] =  0.1 ; 		 /* percentage_minimum_dist=0.1 0.1 0.3 0.5 $U ; */
	 C[9] =  0 ; 		 /* w1=0 ; */
	 } 
/* End of loading constants */ 
void load_auxlevel(double AUX[], double y[], double C[]) {
	 /* Filling leval and aux variables with initial conditions */ 
	 AUX[1] =  0.0; 	 /* trucks_in = */ 
	 AUX[2] =  0.0; 	 /* queue_line_a = */ 
	 AUX[3] =  0.0; 	 /* queue_line_b = */ 
} 


void update_variables_lhs(int c, double C[]) { 
	 /* Updates the following variables at point given by c */ 
	 
	 if (c == 0)   { 
 		 C[1] = 11.25; 
 		 C[2] = 84.3; 
 		 C[3] = 5.08; 
 		 C[4] = 31.15; 
 		 C[5] = 78.85; 
 		 C[6] = 135.05; 
 		 C[7] = 34.95; 
 		 C[8] = 0.23; 
	 } 
	 if (c == 1)   { 
 		 C[1] = 7.85; 
 		 C[2] = 74.1; 
 		 C[3] = 3.72; 
 		 C[4] = 91.45; 
 		 C[5] = 99.55; 
 		 C[6] = 141.55; 
 		 C[7] = 37.55; 
 		 C[8] = 0.162; 
	 } 
	 if (c == 2)   { 
 		 C[1] = 10.15; 
 		 C[2] = 69.3; 
 		 C[3] = 9.24; 
 		 C[4] = 62.65; 
 		 C[5] = 35.65; 
 		 C[6] = 106.45; 
 		 C[7] = 57.05; 
 		 C[8] = 0.446; 
	 } 
	 if (c == 3)   { 
 		 C[1] = 14.25; 
 		 C[2] = 44.7; 
 		 C[3] = 8.44; 
 		 C[4] = 94.15; 
 		 C[5] = 36.55; 
 		 C[6] = 51.85; 
 		 C[7] = 128.55; 
 		 C[8] = 0.182; 
	 } 
	 if (c == 4)   { 
 		 C[1] = 8.95; 
 		 C[2] = 32.7; 
 		 C[3] = 6.04; 
 		 C[4] = 14.95; 
 		 C[5] = 74.35; 
 		 C[6] = 94.75; 
 		 C[7] = 53.15; 
 		 C[8] = 0.282; 
	 } 
	 if (c == 5)   { 
 		 C[1] = 10.95; 
 		 C[2] = 78.3; 
 		 C[3] = 7.32; 
 		 C[4] = 82.45; 
 		 C[5] = 59.05; 
 		 C[6] = 127.25; 
 		 C[7] = 93.45; 
 		 C[8] = 0.302; 
	 } 
	 if (c == 6)   { 
 		 C[1] = 7.65; 
 		 C[2] = 38.7; 
 		 C[3] = 2.44; 
 		 C[4] = 77.05; 
 		 C[5] = 46.45; 
 		 C[6] = 84.35; 
 		 C[7] = 103.85; 
 		 C[8] = 0.286; 
	 } 
	 if (c == 7)   { 
 		 C[1] = 12.65; 
 		 C[2] = 79.5; 
 		 C[3] = 5.96; 
 		 C[4] = 26.65; 
 		 C[5] = 86.95; 
 		 C[6] = 40.15; 
 		 C[7] = 124.65; 
 		 C[8] = 0.226; 
	 } 
	 if (c == 8)   { 
 		 C[1] = 13.75; 
 		 C[2] = 72.3; 
 		 C[3] = 7.4; 
 		 C[4] = 19.45; 
 		 C[5] = 42.85; 
 		 C[6] = 28.45; 
 		 C[7] = 99.95; 
 		 C[8] = 0.178; 
	 } 
	 if (c == 9)   { 
 		 C[1] = 9.95; 
 		 C[2] = 63.3; 
 		 C[3] = 3.64; 
 		 C[4] = 44.65; 
 		 C[5] = 43.75; 
 		 C[6] = 46.65; 
 		 C[7] = 84.35; 
 		 C[8] = 0.41; 
	 } 
	 if (c == 10)   { 
 		 C[1] = 8.35; 
 		 C[2] = 85.5; 
 		 C[3] = 6.52; 
 		 C[4] = 65.35; 
 		 C[5] = 21.25; 
 		 C[6] = 53.15; 
 		 C[7] = 41.45; 
 		 C[8] = 0.222; 
	 } 
	 if (c == 11)   { 
 		 C[1] = 12.15; 
 		 C[2] = 80.1; 
 		 C[3] = 3.4; 
 		 C[4] = 66.25; 
 		 C[5] = 75.25; 
 		 C[6] = 62.25; 
 		 C[7] = 107.75; 
 		 C[8] = 0.31; 
	 } 
	 if (c == 12)   { 
 		 C[1] = 8.75; 
 		 C[2] = 81.9; 
 		 C[3] = 5; 
 		 C[4] = 95.05; 
 		 C[5] = 64.45; 
 		 C[6] = 71.35; 
 		 C[7] = 54.45; 
 		 C[8] = 0.458; 
	 } 
	 if (c == 13)   { 
 		 C[1] = 13.65; 
 		 C[2] = 68.7; 
 		 C[3] = 9.16; 
 		 C[4] = 29.35; 
 		 C[5] = 68.95; 
 		 C[6] = 109.05; 
 		 C[7] = 137.65; 
 		 C[8] = 0.158; 
	 } 
	 if (c == 14)   { 
 		 C[1] = 12.75; 
 		 C[2] = 66.3; 
 		 C[3] = 2.76; 
 		 C[4] = 30.25; 
 		 C[5] = 11.35; 
 		 C[6] = 57.05; 
 		 C[7] = 70.05; 
 		 C[8] = 0.45; 
	 } 
	 if (c == 15)   { 
 		 C[1] = 8.45; 
 		 C[2] = 49.5; 
 		 C[3] = 3.88; 
 		 C[4] = 69.85; 
 		 C[5] = 32.05; 
 		 C[6] = 34.95; 
 		 C[7] = 28.45; 
 		 C[8] = 0.214; 
	 } 
	 if (c == 16)   { 
 		 C[1] = 14.35; 
 		 C[2] = 76.5; 
 		 C[3] = 2.28; 
 		 C[4] = 60.85; 
 		 C[5] = 40.15; 
 		 C[6] = 90.85; 
 		 C[7] = 21.95; 
 		 C[8] = 0.426; 
	 } 
	 if (c == 17)   { 
 		 C[1] = 8.85; 
 		 C[2] = 42.3; 
 		 C[3] = 3.56; 
 		 C[4] = 32.05; 
 		 C[5] = 79.75; 
 		 C[6] = 36.25; 
 		 C[7] = 51.85; 
 		 C[8] = 0.17; 
	 } 
	 if (c == 18)   { 
 		 C[1] = 13.85; 
 		 C[2] = 51.3; 
 		 C[3] = 2.52; 
 		 C[4] = 41.95; 
 		 C[5] = 55.45; 
 		 C[6] = 131.15; 
 		 C[7] = 102.55; 
 		 C[8] = 0.358; 
	 } 
	 if (c == 19)   { 
 		 C[1] = 9.85; 
 		 C[2] = 46.5; 
 		 C[3] = 5.88; 
 		 C[4] = 23.05; 
 		 C[5] = 48.25; 
 		 C[6] = 125.95; 
 		 C[7] = 59.65; 
 		 C[8] = 0.238; 
	 } 
	 if (c == 20)   { 
 		 C[1] = 10.45; 
 		 C[2] = 30.9; 
 		 C[3] = 4.52; 
 		 C[4] = 59.05; 
 		 C[5] = 59.95; 
 		 C[6] = 27.15; 
 		 C[7] = 68.75; 
 		 C[8] = 0.338; 
	 } 
	 if (c == 21)   { 
 		 C[1] = 7.35; 
 		 C[2] = 88.5; 
 		 C[3] = 4.04; 
 		 C[4] = 84.25; 
 		 C[5] = 90.55; 
 		 C[6] = 72.65; 
 		 C[7] = 80.45; 
 		 C[8] = 0.294; 
	 } 
	 if (c == 22)   { 
 		 C[1] = 7.15; 
 		 C[2] = 45.9; 
 		 C[3] = 9.4; 
 		 C[4] = 64.45; 
 		 C[5] = 97.75; 
 		 C[6] = 37.55; 
 		 C[7] = 63.55; 
 		 C[8] = 0.494; 
	 } 
	 if (c == 23)   { 
 		 C[1] = 7.55; 
 		 C[2] = 50.1; 
 		 C[3] = 5.24; 
 		 C[4] = 10.45; 
 		 C[5] = 39.25; 
 		 C[6] = 29.75; 
 		 C[7] = 25.85; 
 		 C[8] = 0.43; 
	 } 
	 if (c == 24)   { 
 		 C[1] = 5.75; 
 		 C[2] = 65.7; 
 		 C[3] = 4.28; 
 		 C[4] = 48.25; 
 		 C[5] = 18.55; 
 		 C[6] = 148.05; 
 		 C[7] = 45.35; 
 		 C[8] = 0.246; 
	 } 
	 if (c == 25)   { 
 		 C[1] = 8.25; 
 		 C[2] = 66.9; 
 		 C[3] = 9.96; 
 		 C[4] = 43.75; 
 		 C[5] = 52.75; 
 		 C[6] = 64.85; 
 		 C[7] = 111.65; 
 		 C[8] = 0.102; 
	 } 
	 if (c == 26)   { 
 		 C[1] = 13.05; 
 		 C[2] = 39.3; 
 		 C[3] = 8.12; 
 		 C[4] = 45.55; 
 		 C[5] = 71.65; 
 		 C[6] = 122.05; 
 		 C[7] = 47.95; 
 		 C[8] = 0.278; 
	 } 
	 if (c == 27)   { 
 		 C[1] = 5.95; 
 		 C[2] = 50.7; 
 		 C[3] = 4.44; 
 		 C[4] = 36.55; 
 		 C[5] = 38.35; 
 		 C[6] = 45.35; 
 		 C[7] = 122.05; 
 		 C[8] = 0.406; 
	 } 
	 if (c == 28)   { 
 		 C[1] = 9.15; 
 		 C[2] = 64.5; 
 		 C[3] = 6.2; 
 		 C[4] = 47.35; 
 		 C[5] = 72.55; 
 		 C[6] = 58.35; 
 		 C[7] = 71.35; 
 		 C[8] = 0.466; 
	 } 
	 if (c == 29)   { 
 		 C[1] = 10.25; 
 		 C[2] = 78.9; 
 		 C[3] = 2.92; 
 		 C[4] = 86.05; 
 		 C[5] = 50.05; 
 		 C[6] = 93.45; 
 		 C[7] = 123.35; 
 		 C[8] = 0.322; 
	 } 
	 if (c == 30)   { 
 		 C[1] = 6.95; 
 		 C[2] = 57.3; 
 		 C[3] = 5.48; 
 		 C[4] = 58.15; 
 		 C[5] = 45.55; 
 		 C[6] = 142.85; 
 		 C[7] = 77.85; 
 		 C[8] = 0.118; 
	 } 
	 if (c == 31)   { 
 		 C[1] = 7.95; 
 		 C[2] = 84.9; 
 		 C[3] = 3.16; 
 		 C[4] = 12.25; 
 		 C[5] = 95.95; 
 		 C[6] = 54.45; 
 		 C[7] = 36.25; 
 		 C[8] = 0.262; 
	 } 
	 if (c == 32)   { 
 		 C[1] = 10.35; 
 		 C[2] = 41.1; 
 		 C[3] = 8.92; 
 		 C[4] = 37.45; 
 		 C[5] = 51.85; 
 		 C[6] = 20.65; 
 		 C[7] = 66.15; 
 		 C[8] = 0.27; 
	 } 
	 if (c == 33)   { 
 		 C[1] = 6.25; 
 		 C[2] = 48.3; 
 		 C[3] = 6.92; 
 		 C[4] = 81.55; 
 		 C[5] = 61.75; 
 		 C[6] = 92.15; 
 		 C[7] = 97.35; 
 		 C[8] = 0.374; 
	 } 
	 if (c == 34)   { 
 		 C[1] = 5.25; 
 		 C[2] = 71.1; 
 		 C[3] = 5.56; 
 		 C[4] = 28.45; 
 		 C[5] = 53.65; 
 		 C[6] = 118.15; 
 		 C[7] = 62.25; 
 		 C[8] = 0.362; 
	 } 
	 if (c == 35)   { 
 		 C[1] = 13.35; 
 		 C[2] = 57.9; 
 		 C[3] = 6.44; 
 		 C[4] = 78.85; 
 		 C[5] = 30.25; 
 		 C[6] = 144.15; 
 		 C[7] = 31.05; 
 		 C[8] = 0.218; 
	 } 
	 if (c == 36)   { 
 		 C[1] = 9.05; 
 		 C[2] = 58.5; 
 		 C[3] = 7.8; 
 		 C[4] = 20.35; 
 		 C[5] = 60.85; 
 		 C[6] = 42.75; 
 		 C[7] = 27.15; 
 		 C[8] = 0.29; 
	 } 
	 if (c == 37)   { 
 		 C[1] = 9.65; 
 		 C[2] = 60.9; 
 		 C[3] = 2.6; 
 		 C[4] = 61.75; 
 		 C[5] = 66.25; 
 		 C[6] = 149.35; 
 		 C[7] = 112.95; 
 		 C[8] = 0.342; 
	 } 
	 if (c == 38)   { 
 		 C[1] = 12.35; 
 		 C[2] = 70.5; 
 		 C[3] = 3.96; 
 		 C[4] = 38.35; 
 		 C[5] = 41.05; 
 		 C[6] = 132.45; 
 		 C[7] = 64.85; 
 		 C[8] = 0.202; 
	 } 
	 if (c == 39)   { 
 		 C[1] = 10.85; 
 		 C[2] = 55.5; 
 		 C[3] = 3.08; 
 		 C[4] = 24.85; 
 		 C[5] = 49.15; 
 		 C[6] = 101.25; 
 		 C[7] = 96.05; 
 		 C[8] = 0.142; 
	 } 
	 if (c == 40)   { 
 		 C[1] = 14.85; 
 		 C[2] = 61.5; 
 		 C[3] = 4.92; 
 		 C[4] = 63.55; 
 		 C[5] = 85.15; 
 		 C[6] = 97.35; 
 		 C[7] = 90.85; 
 		 C[8] = 0.366; 
	 } 
	 if (c == 41)   { 
 		 C[1] = 11.15; 
 		 C[2] = 53.7; 
 		 C[3] = 2.84; 
 		 C[4] = 71.65; 
 		 C[5] = 86.05; 
 		 C[6] = 31.05; 
 		 C[7] = 20.65; 
 		 C[8] = 0.39; 
	 } 
	 if (c == 42)   { 
 		 C[1] = 9.45; 
 		 C[2] = 40.5; 
 		 C[3] = 6.36; 
 		 C[4] = 77.95; 
 		 C[5] = 50.95; 
 		 C[6] = 80.45; 
 		 C[7] = 58.35; 
 		 C[8] = 0.462; 
	 } 
	 if (c == 43)   { 
 		 C[1] = 8.05; 
 		 C[2] = 38.1; 
 		 C[3] = 4.2; 
 		 C[4] = 68.95; 
 		 C[5] = 28.45; 
 		 C[6] = 124.65; 
 		 C[7] = 38.85; 
 		 C[8] = 0.19; 
	 } 
	 if (c == 44)   { 
 		 C[1] = 8.65; 
 		 C[2] = 80.7; 
 		 C[3] = 5.72; 
 		 C[4] = 70.75; 
 		 C[5] = 37.45; 
 		 C[6] = 68.75; 
 		 C[7] = 60.95; 
 		 C[8] = 0.382; 
	 } 
	 if (c == 45)   { 
 		 C[1] = 14.65; 
 		 C[2] = 34.5; 
 		 C[3] = 2.36; 
 		 C[4] = 85.15; 
 		 C[5] = 83.35; 
 		 C[6] = 96.05; 
 		 C[7] = 133.75; 
 		 C[8] = 0.314; 
	 } 
	 if (c == 46)   { 
 		 C[1] = 5.15; 
 		 C[2] = 71.7; 
 		 C[3] = 3; 
 		 C[4] = 46.45; 
 		 C[5] = 92.35; 
 		 C[6] = 120.75; 
 		 C[7] = 149.35; 
 		 C[8] = 0.126; 
	 } 
	 if (c == 47)   { 
 		 C[1] = 14.95; 
 		 C[2] = 47.7; 
 		 C[3] = 4.68; 
 		 C[4] = 93.25; 
 		 C[5] = 26.65; 
 		 C[6] = 115.55; 
 		 C[7] = 73.95; 
 		 C[8] = 0.254; 
	 } 
	 if (c == 48)   { 
 		 C[1] = 11.55; 
 		 C[2] = 73.5; 
 		 C[3] = 7.48; 
 		 C[4] = 74.35; 
 		 C[5] = 63.55; 
 		 C[6] = 138.95; 
 		 C[7] = 49.25; 
 		 C[8] = 0.166; 
	 } 
	 if (c == 49)   { 
 		 C[1] = 12.95; 
 		 C[2] = 35.7; 
 		 C[3] = 4.12; 
 		 C[4] = 17.65; 
 		 C[5] = 70.75; 
 		 C[6] = 137.65; 
 		 C[7] = 72.65; 
 		 C[8] = 0.486; 
	 } 
	 if (c == 50)   { 
 		 C[1] = 14.45; 
 		 C[2] = 77.7; 
 		 C[3] = 3.48; 
 		 C[4] = 21.25; 
 		 C[5] = 34.75; 
 		 C[6] = 140.25; 
 		 C[7] = 94.75; 
 		 C[8] = 0.394; 
	 } 
	 if (c == 51)   { 
 		 C[1] = 12.45; 
 		 C[2] = 62.7; 
 		 C[3] = 8.6; 
 		 C[4] = 42.85; 
 		 C[5] = 69.85; 
 		 C[6] = 83.05; 
 		 C[7] = 110.35; 
 		 C[8] = 0.418; 
	 } 
	 if (c == 52)   { 
 		 C[1] = 14.55; 
 		 C[2] = 77.1; 
 		 C[3] = 7.64; 
 		 C[4] = 15.85; 
 		 C[5] = 62.65; 
 		 C[6] = 25.85; 
 		 C[7] = 40.15; 
 		 C[8] = 0.258; 
	 } 
	 if (c == 53)   { 
 		 C[1] = 14.75; 
 		 C[2] = 89.7; 
 		 C[3] = 6.68; 
 		 C[4] = 87.85; 
 		 C[5] = 32.95; 
 		 C[6] = 55.75; 
 		 C[7] = 145.45; 
 		 C[8] = 0.138; 
	 } 
	 if (c == 54)   { 
 		 C[1] = 5.35; 
 		 C[2] = 63.9; 
 		 C[3] = 9.64; 
 		 C[4] = 22.15; 
 		 C[5] = 15.85; 
 		 C[6] = 38.85; 
 		 C[7] = 114.25; 
 		 C[8] = 0.114; 
	 } 
	 if (c == 55)   { 
 		 C[1] = 5.05; 
 		 C[2] = 52.5; 
 		 C[3] = 6.76; 
 		 C[4] = 55.45; 
 		 C[5] = 58.15; 
 		 C[6] = 59.65; 
 		 C[7] = 148.05; 
 		 C[8] = 0.194; 
	 } 
	 if (c == 56)   { 
 		 C[1] = 6.65; 
 		 C[2] = 37.5; 
 		 C[3] = 6.12; 
 		 C[4] = 75.25; 
 		 C[5] = 14.95; 
 		 C[6] = 129.85; 
 		 C[7] = 46.65; 
 		 C[8] = 0.154; 
	 } 
	 if (c == 57)   { 
 		 C[1] = 5.45; 
 		 C[2] = 45.3; 
 		 C[3] = 5.64; 
 		 C[4] = 56.35; 
 		 C[5] = 13.15; 
 		 C[6] = 136.35; 
 		 C[7] = 85.65; 
 		 C[8] = 0.49; 
	 } 
	 if (c == 58)   { 
 		 C[1] = 13.95; 
 		 C[2] = 59.1; 
 		 C[3] = 8.84; 
 		 C[4] = 39.25; 
 		 C[5] = 33.85; 
 		 C[6] = 33.65; 
 		 C[7] = 83.05; 
 		 C[8] = 0.354; 
	 } 
	 if (c == 59)   { 
 		 C[1] = 6.15; 
 		 C[2] = 86.1; 
 		 C[3] = 7.72; 
 		 C[4] = 49.15; 
 		 C[5] = 76.15; 
 		 C[6] = 98.65; 
 		 C[7] = 119.45; 
 		 C[8] = 0.234; 
	 } 
	 if (c == 60)   { 
 		 C[1] = 6.45; 
 		 C[2] = 75.3; 
 		 C[3] = 7.16; 
 		 C[4] = 79.75; 
 		 C[5] = 98.65; 
 		 C[6] = 99.95; 
 		 C[7] = 42.75; 
 		 C[8] = 0.206; 
	 } 
	 if (c == 61)   { 
 		 C[1] = 5.65; 
 		 C[2] = 31.5; 
 		 C[3] = 8.36; 
 		 C[4] = 35.65; 
 		 C[5] = 68.05; 
 		 C[6] = 66.15; 
 		 C[7] = 115.55; 
 		 C[8] = 0.498; 
	 } 
	 if (c == 62)   { 
 		 C[1] = 6.05; 
 		 C[2] = 54.3; 
 		 C[3] = 4.6; 
 		 C[4] = 23.95; 
 		 C[5] = 16.75; 
 		 C[6] = 102.55; 
 		 C[7] = 105.15; 
 		 C[8] = 0.438; 
	 } 
	 if (c == 63)   { 
 		 C[1] = 6.35; 
 		 C[2] = 74.7; 
 		 C[3] = 6.28; 
 		 C[4] = 33.85; 
 		 C[5] = 81.55; 
 		 C[6] = 60.95; 
 		 C[7] = 101.25; 
 		 C[8] = 0.478; 
	 } 
	 if (c == 64)   { 
 		 C[1] = 12.05; 
 		 C[2] = 56.7; 
 		 C[3] = 7.24; 
 		 C[4] = 96.85; 
 		 C[5] = 89.65; 
 		 C[6] = 21.95; 
 		 C[7] = 106.45; 
 		 C[8] = 0.482; 
	 } 
	 if (c == 65)   { 
 		 C[1] = 11.85; 
 		 C[2] = 68.1; 
 		 C[3] = 4.76; 
 		 C[4] = 52.75; 
 		 C[5] = 94.15; 
 		 C[6] = 111.65; 
 		 C[7] = 140.25; 
 		 C[8] = 0.134; 
	 } 
	 if (c == 66)   { 
 		 C[1] = 5.85; 
 		 C[2] = 33.3; 
 		 C[3] = 9.08; 
 		 C[4] = 27.55; 
 		 C[5] = 44.65; 
 		 C[6] = 89.55; 
 		 C[7] = 142.85; 
 		 C[8] = 0.346; 
	 } 
	 if (c == 67)   { 
 		 C[1] = 11.95; 
 		 C[2] = 60.3; 
 		 C[3] = 9.32; 
 		 C[4] = 18.55; 
 		 C[5] = 12.25; 
 		 C[6] = 73.95; 
 		 C[7] = 88.25; 
 		 C[8] = 0.33; 
	 } 
	 if (c == 68)   { 
 		 C[1] = 13.15; 
 		 C[2] = 87.9; 
 		 C[3] = 3.32; 
 		 C[4] = 25.75; 
 		 C[5] = 96.85; 
 		 C[6] = 77.85; 
 		 C[7] = 132.45; 
 		 C[8] = 0.13; 
	 } 
	 if (c == 69)   { 
 		 C[1] = 11.35; 
 		 C[2] = 44.1; 
 		 C[3] = 3.8; 
 		 C[4] = 16.75; 
 		 C[5] = 91.45; 
 		 C[6] = 114.25; 
 		 C[7] = 29.75; 
 		 C[8] = 0.186; 
	 } 
	 if (c == 70)   { 
 		 C[1] = 9.55; 
 		 C[2] = 35.1; 
 		 C[3] = 3.24; 
 		 C[4] = 57.25; 
 		 C[5] = 14.05; 
 		 C[6] = 79.15; 
 		 C[7] = 55.75; 
 		 C[8] = 0.35; 
	 } 
	 if (c == 71)   { 
 		 C[1] = 9.75; 
 		 C[2] = 67.5; 
 		 C[3] = 2.2; 
 		 C[4] = 53.65; 
 		 C[5] = 25.75; 
 		 C[6] = 105.15; 
 		 C[7] = 146.75; 
 		 C[8] = 0.454; 
	 } 
	 if (c == 72)   { 
 		 C[1] = 6.75; 
 		 C[2] = 75.9; 
 		 C[3] = 5.32; 
 		 C[4] = 32.95; 
 		 C[5] = 54.55; 
 		 C[6] = 32.35; 
 		 C[7] = 23.25; 
 		 C[8] = 0.37; 
	 } 
	 if (c == 73)   { 
 		 C[1] = 10.05; 
 		 C[2] = 87.3; 
 		 C[3] = 7.88; 
 		 C[4] = 40.15; 
 		 C[5] = 65.35; 
 		 C[6] = 128.55; 
 		 C[7] = 120.75; 
 		 C[8] = 0.442; 
	 } 
	 if (c == 74)   { 
 		 C[1] = 10.55; 
 		 C[2] = 62.1; 
 		 C[3] = 8.76; 
 		 C[4] = 14.05; 
 		 C[5] = 22.15; 
 		 C[6] = 146.75; 
 		 C[7] = 136.35; 
 		 C[8] = 0.146; 
	 } 
	 if (c == 75)   { 
 		 C[1] = 6.55; 
 		 C[2] = 89.1; 
 		 C[3] = 7.56; 
 		 C[4] = 11.35; 
 		 C[5] = 17.65; 
 		 C[6] = 88.25; 
 		 C[7] = 92.15; 
 		 C[8] = 0.298; 
	 } 
	 if (c == 76)   { 
 		 C[1] = 5.55; 
 		 C[2] = 65.1; 
 		 C[3] = 8.52; 
 		 C[4] = 83.35; 
 		 C[5] = 47.35; 
 		 C[6] = 123.35; 
 		 C[7] = 109.05; 
 		 C[8] = 0.274; 
	 } 
	 if (c == 77)   { 
 		 C[1] = 14.05; 
 		 C[2] = 51.9; 
 		 C[3] = 8.2; 
 		 C[4] = 76.15; 
 		 C[5] = 56.35; 
 		 C[6] = 103.85; 
 		 C[7] = 135.05; 
 		 C[8] = 0.306; 
	 } 
	 if (c == 78)   { 
 		 C[1] = 7.05; 
 		 C[2] = 36.9; 
 		 C[3] = 9; 
 		 C[4] = 98.65; 
 		 C[5] = 10.45; 
 		 C[6] = 110.35; 
 		 C[7] = 138.95; 
 		 C[8] = 0.422; 
	 } 
	 if (c == 79)   { 
 		 C[1] = 11.45; 
 		 C[2] = 30.3; 
 		 C[3] = 2.12; 
 		 C[4] = 73.45; 
 		 C[5] = 77.05; 
 		 C[6] = 63.55; 
 		 C[7] = 127.25; 
 		 C[8] = 0.47; 
	 } 
	 if (c == 80)   { 
 		 C[1] = 12.85; 
 		 C[2] = 59.7; 
 		 C[3] = 2.04; 
 		 C[4] = 80.65; 
 		 C[5] = 88.75; 
 		 C[6] = 70.05; 
 		 C[7] = 81.75; 
 		 C[8] = 0.242; 
	 } 
	 if (c == 81)   { 
 		 C[1] = 9.35; 
 		 C[2] = 81.3; 
 		 C[3] = 5.16; 
 		 C[4] = 72.55; 
 		 C[5] = 80.65; 
 		 C[6] = 50.55; 
 		 C[7] = 32.35; 
 		 C[8] = 0.106; 
	 } 
	 if (c == 82)   { 
 		 C[1] = 7.45; 
 		 C[2] = 33.9; 
 		 C[3] = 8.68; 
 		 C[4] = 54.55; 
 		 C[5] = 87.85; 
 		 C[6] = 24.55; 
 		 C[7] = 125.95; 
 		 C[8] = 0.386; 
	 } 
	 if (c == 83)   { 
 		 C[1] = 13.55; 
 		 C[2] = 41.7; 
 		 C[3] = 9.88; 
 		 C[4] = 41.05; 
 		 C[5] = 23.95; 
 		 C[6] = 85.65; 
 		 C[7] = 118.15; 
 		 C[8] = 0.198; 
	 } 
	 if (c == 84)   { 
 		 C[1] = 12.25; 
 		 C[2] = 72.9; 
 		 C[3] = 9.8; 
 		 C[4] = 13.15; 
 		 C[5] = 24.85; 
 		 C[6] = 44.05; 
 		 C[7] = 79.15; 
 		 C[8] = 0.122; 
	 } 
	 if (c == 85)   { 
 		 C[1] = 13.45; 
 		 C[2] = 83.7; 
 		 C[3] = 4.36; 
 		 C[4] = 50.05; 
 		 C[5] = 23.05; 
 		 C[6] = 116.85; 
 		 C[7] = 33.65; 
 		 C[8] = 0.266; 
	 } 
	 if (c == 86)   { 
 		 C[1] = 11.65; 
 		 C[2] = 56.1; 
 		 C[3] = 7; 
 		 C[4] = 89.65; 
 		 C[5] = 27.55; 
 		 C[6] = 49.25; 
 		 C[7] = 75.25; 
 		 C[8] = 0.434; 
	 } 
	 if (c == 87)   { 
 		 C[1] = 11.75; 
 		 C[2] = 83.1; 
 		 C[3] = 6.84; 
 		 C[4] = 51.85; 
 		 C[5] = 82.45; 
 		 C[6] = 119.45; 
 		 C[7] = 86.95; 
 		 C[8] = 0.318; 
	 } 
	 if (c == 88)   { 
 		 C[1] = 11.05; 
 		 C[2] = 69.9; 
 		 C[3] = 2.68; 
 		 C[4] = 88.75; 
 		 C[5] = 31.15; 
 		 C[6] = 67.45; 
 		 C[7] = 67.45; 
 		 C[8] = 0.402; 
	 } 
	 if (c == 89)   { 
 		 C[1] = 13.25; 
 		 C[2] = 53.1; 
 		 C[3] = 5.8; 
 		 C[4] = 90.55; 
 		 C[5] = 57.25; 
 		 C[6] = 23.25; 
 		 C[7] = 98.65; 
 		 C[8] = 0.174; 
	 } 
	 if (c == 90)   { 
 		 C[1] = 14.15; 
 		 C[2] = 48.9; 
 		 C[3] = 9.56; 
 		 C[4] = 34.75; 
 		 C[5] = 41.95; 
 		 C[6] = 133.75; 
 		 C[7] = 44.05; 
 		 C[8] = 0.326; 
	 } 
	 if (c == 91)   { 
 		 C[1] = 10.75; 
 		 C[2] = 36.3; 
 		 C[3] = 7.08; 
 		 C[4] = 97.75; 
 		 C[5] = 84.25; 
 		 C[6] = 86.95; 
 		 C[7] = 144.15; 
 		 C[8] = 0.474; 
	 } 
	 if (c == 92)   { 
 		 C[1] = 6.85; 
 		 C[2] = 43.5; 
 		 C[3] = 9.48; 
 		 C[4] = 92.35; 
 		 C[5] = 77.95; 
 		 C[6] = 112.95; 
 		 C[7] = 89.55; 
 		 C[8] = 0.15; 
	 } 
	 if (c == 93)   { 
 		 C[1] = 8.55; 
 		 C[2] = 39.9; 
 		 C[3] = 5.4; 
 		 C[4] = 86.95; 
 		 C[5] = 93.25; 
 		 C[6] = 75.25; 
 		 C[7] = 76.55; 
 		 C[8] = 0.334; 
	 } 
	 if (c == 94)   { 
 		 C[1] = 12.55; 
 		 C[2] = 82.5; 
 		 C[3] = 9.72; 
 		 C[4] = 95.95; 
 		 C[5] = 19.45; 
 		 C[6] = 41.45; 
 		 C[7] = 141.55; 
 		 C[8] = 0.25; 
	 } 
	 if (c == 95)   { 
 		 C[1] = 10.65; 
 		 C[2] = 86.7; 
 		 C[3] = 8.28; 
 		 C[4] = 99.55; 
 		 C[5] = 20.35; 
 		 C[6] = 145.45; 
 		 C[7] = 24.55; 
 		 C[8] = 0.378; 
	 } 
	 if (c == 96)   { 
 		 C[1] = 9.25; 
 		 C[2] = 54.9; 
 		 C[3] = 7.96; 
 		 C[4] = 50.95; 
 		 C[5] = 73.45; 
 		 C[6] = 76.55; 
 		 C[7] = 129.85; 
 		 C[8] = 0.11; 
	 } 
	 if (c == 97)   { 
 		 C[1] = 7.25; 
 		 C[2] = 42.9; 
 		 C[3] = 8.04; 
 		 C[4] = 67.15; 
 		 C[5] = 29.35; 
 		 C[6] = 107.75; 
 		 C[7] = 50.55; 
 		 C[8] = 0.21; 
	 } 
	 if (c == 98)   { 
 		 C[1] = 7.75; 
 		 C[2] = 32.1; 
 		 C[3] = 4.84; 
 		 C[4] = 68.05; 
 		 C[5] = 67.15; 
 		 C[6] = 81.75; 
 		 C[7] = 131.15; 
 		 C[8] = 0.398; 
	 } 
	 if (c == 99)   { 
 		 C[1] = 8.15; 
 		 C[2] = 47.1; 
 		 C[3] = 6.6; 
 		 C[4] = 59.95; 
 		 C[5] = 95.05; 
 		 C[6] = 47.95; 
 		 C[7] = 116.85; 
 		 C[8] = 0.414; 
	 } 
 } /*  End of update_variables_lhs  */ 


static int nfigsloaded; 
int load_data_figures(double FIGS[][MAX_FIGS], eqfig figdata[], int nfigs, int jj, double y[], double C[], double AUX[], double x, FILE * myfile) { 
	 int j = nfigsloaded; 
	 int i; int errorover=0; 
		  FIGS[0][j] = x; 
		  if (! finite(AUX[1])) { printf("Overflow error on variable trucks_in \n"); errorover++; } 
		  FIGS[1][j] = AUX[1];
		  if (figdata[1].max < FIGS[1][j]) { figdata[1].max =  FIGS[1][j]; } 
		  if (figdata[1].min > FIGS[1][j]) { figdata[1].min =  FIGS[1][j]; } 
		  if (! finite(AUX[2])) { printf("Overflow error on variable queue_line_a \n"); errorover++; } 
		  FIGS[2][j] = AUX[2];
		  if (figdata[2].max < FIGS[2][j]) { figdata[2].max =  FIGS[2][j]; } 
		  if (figdata[2].min > FIGS[2][j]) { figdata[2].min =  FIGS[2][j]; } 
		  if (! finite(AUX[3])) { printf("Overflow error on variable queue_line_b \n"); errorover++; } 
		  FIGS[3][j] = AUX[3];
		  if (figdata[3].max < FIGS[3][j]) { figdata[3].max =  FIGS[3][j]; } 
		  if (figdata[3].min > FIGS[3][j]) { figdata[3].min =  FIGS[3][j]; } 
	 nfigsloaded ++;
	 if (nfigsloaded >= MAX_FIGS ) { int xx, yy; 
		 for (xx=0;xx<MAX_FIGS;xx++) { 
		 fprintf(myfile,"%f\t",FIGS[0][xx]); 
		  for (yy=1;yy<=3;yy++) 
			  fprintf(myfile, "%.6e\t",FIGS[yy][xx]); 
		 fprintf(myfile,"\n"); 
} nfigsloaded =0; } 
 return errorover; 
} 


int main (void) 
{ 
	 time_t init_time=time(NULL), end_time; double mydifftime;
	 int i,j, resode=0;  int myc=0; 
	 double h, x=1.0, *y, *dydx, *yout, *C, *AUX; 
	 FILE *stream; 
	 char filename[5]; 
	 int nfigs = 3;
	 eqfig figdata[5];
	 double FIGS[5][MAX_FIGS]; 
	 int maxloop =0, nloop =0; int figres=0; 
	 y    =  dvector(1,N);  
	 dydx =  dvector(1,N); 
	 yout =  dvector(1,N);  
	 C   =   dvector(1,NINC); 
	 AUX =   dvector(1,N); 
	 nfigsloaded = 0; 
	 for(i=1;i<=nfigs;i++) { figdata[i].max = -HUGE_VAL; figdata[i].min=HUGE_VAL; }; 
	  strcpy(figdata[1].name,"trucks_in");
	  strcpy(figdata[2].name,"queue_line_a");
	  strcpy(figdata[3].name,"queue_line_b");
	 while (myc < 100) { 
	 load_constants(C); 
	 update_variables_lhs(myc, C); 
	 load_auxlevel(AUX,y,C); 
	 nfigsloaded = 0; 
	 /* ---rk4--- */ 
	 h = (double)0.1;
	 x = (double)0; 
	 maxloop = (int) (3600/h)+1;
	 nloop = 0; 
	 j=0; 
	 printf("Solving run %d \n", myc+1);
	 sprintf(filename, "%04u", myc+1); 
	 stream = fopen(filename,"w"  ); 
	 while(nloop <= maxloop) {
		 if (nloop % (int)ceil(1/h) == 0) {
		 resode=load_data_figures(FIGS, figdata, nfigs, j, y, C, AUX, x,  stream);
		 if (resode > 0) break; 
			 j++; }  
		 derivs(x,y,dydx,C, AUX); 
		 rk4(y,dydx,N,x,h,yout,derivs, C, AUX); 
		 for(i=0; i<N; i++) 
		 y[i] = yout[i]; 
		 nloop++; 
		 x = x + h;
	 }  
	for(i=0; i<nfigsloaded; i++) { 
		 fprintf(stream,"%f\t",FIGS[0][i]);
		 for(j=1; j<=nfigs; j++) fprintf(stream,"%.5e\t",FIGS[j][i]); 
		 fprintf(stream,"\n"); }; 
		 fclose(stream); 
	 if (resode > 0) { printf( "Error solving run %d \n", myc+1); break;	} 
	 myc++; } 
	 WritePlotScript(1, nfigs, 4320, figdata, 0, myc-1);
	 myreturnsyscall = system("rm output1.pdf; gnuplot plot.scr &"); 
	 free_dvector(yout,1,N); 
	 free_dvector(dydx,1,N); 
	 free_dvector(y,1,N); 
	 free_dvector(C,1,NINC); 
	 free_dvector(AUX,1,N); 
	 end_time = time(NULL); 
	 mydifftime = difftime(end_time, init_time); 
	 printf("##  %f seconds \n",mydifftime); 
	 return 0; 
} 
